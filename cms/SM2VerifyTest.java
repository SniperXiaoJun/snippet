package cms;

import java.io.ByteArrayInputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.RandomAccessFile;
import java.math.BigInteger;
import java.nio.MappedByteBuffer;
import java.nio.channels.FileChannel;
import java.nio.channels.FileChannel.MapMode;
import java.security.InvalidKeyException;
import java.security.KeyFactory;
import java.security.KeyStore;
import java.security.KeyStoreException;
import java.security.NoSuchAlgorithmException;
import java.security.NoSuchProviderException;
import java.security.PrivateKey;
import java.security.PublicKey;
import java.security.Security;
import java.security.SignatureException;
import java.security.UnrecoverableKeyException;
import java.security.cert.Certificate;
import java.security.cert.CertificateException;
import java.security.cert.CertificateFactory;
import java.security.cert.X509Certificate;
import java.security.spec.PKCS8EncodedKeySpec;
import java.util.Collection;
import java.util.Enumeration;
import java.util.Iterator;
import org.apache.commons.codec.binary.Base64;
import org.bouncycastle.asn1.ASN1InputStream;
import org.bouncycastle.asn1.ASN1Integer;
import org.bouncycastle.asn1.ASN1Primitive;
import org.bouncycastle.asn1.ASN1Sequence;
import org.bouncycastle.asn1.BERApplicationSpecificParser;
import org.bouncycastle.asn1.BERTags;
import org.bouncycastle.asn1.DERApplicationSpecific;
import org.bouncycastle.asn1.DERPrintableString;
import org.bouncycastle.asn1.DERTags;
import org.bouncycastle.asn1.gm.GMObjectIdentifiers;
import org.bouncycastle.asn1.util.ASN1Dump;
import org.bouncycastle.cert.X509CertificateHolder;
import org.bouncycastle.cert.jcajce.JcaX509CertificateConverter;
import org.bouncycastle.cms.CMSSignedData;
import org.bouncycastle.cms.CMSTypedData;
import org.bouncycastle.cms.SignerInformation;
import org.bouncycastle.cms.SignerInformationStore;
import org.bouncycastle.crypto.params.ECDomainParameters;
import org.bouncycastle.crypto.params.ECPrivateKeyParameters;
import org.bouncycastle.crypto.params.ECPublicKeyParameters;
import org.bouncycastle.crypto.params.ParametersWithID;
import org.bouncycastle.crypto.params.ParametersWithRandom;
import org.bouncycastle.crypto.signers.SM2Signer;
import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPrivateKey;
import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPublicKey;
import org.bouncycastle.jce.provider.BouncyCastleProvider;
import org.bouncycastle.jce.spec.ECParameterSpec;
import org.bouncycastle.util.CollectionStore;
import org.bouncycastle.util.test.TestRandomBigInteger;

import sun.misc.BASE64Decoder;
import sun.security.pkcs.ParsingException;

import com.szca.caau.webservice.util.CAUtil;
import com.szca.caau.webservice.util.FileUtil;
import com.szca.sm2.cms.CMSUtil;
import com.szca.sm2.cms.ExternalSignatureCMSSignedDataGenerator;
import com.szca.sm2.cms.ExternalSignatureSignerInfoGenerator;

public class SM2VerifyTest
{
    private static byte[] SM2_USER_ID = "1234567812345678".getBytes();

    static String privateStr = "MIICSwIBADCB7AYHKoZIzj0CATCB4AIBATAsBgcqhkjOPQEBAiEA/////v////////////////////8AAAAA//////////8wRAQg/////v////////////////////8AAAAA//////////wEICjp+p6dn140TVqeS89lCafzl4n1FauPkt28vUFNlA6TBEEEMsSuLB8ZgRlfmQRGajnJlI/jC7/yZgvhcVpFiTNMdMe8Nzai9PZ3nFm9zuNraSFT0KmHfMYqR0AC3zLlITnwoAIhAP////7///////////////9yA99rIcYFK1O79Ak51UEjAgEBBIIBVTCCAVECAQEEIC0F1/K2RGgcrBJAABM6ElQw8W/qxFKv9xZAlwlrDTA5oIHjMIHgAgEBMCwGByqGSM49AQECIQD////+/////////////////////wAAAAD//////////zBEBCD////+/////////////////////wAAAAD//////////AQgKOn6np2fXjRNWp5Lz2UJp/OXifUVq4+S3by9QU2UDpMEQQQyxK4sHxmBGV+ZBEZqOcmUj+MLv/JmC+FxWkWJM0x0x7w3NqL09necWb3O42tpIVPQqYd8xipHQALfMuUhOfCgAiEA/////v///////////////3ID32shxgUrU7v0CTnVQSMCAQGhRANCAASY6WuiQ2X4x0pY+qon1IBD7l26wQgJ+QAU5ludnst8LKUsdgrBUS7gi0/FM+bHqQnTITShveQmyUA0loI3lYBp";
    static String publicKeyStr = "MIIBMzCB7AYHKoZIzj0CATCB4AIBATAsBgcqhkjOPQEBAiEA/////v////////////////////8AAAAA//////////8wRAQg/////v////////////////////8AAAAA//////////wEICjp+p6dn140TVqeS89lCafzl4n1FauPkt28vUFNlA6TBEEEMsSuLB8ZgRlfmQRGajnJlI/jC7/yZgvhcVpFiTNMdMe8Nzai9PZ3nFm9zuNraSFT0KmHfMYqR0AC3zLlITnwoAIhAP////7///////////////9yA99rIcYFK1O79Ak51UEjAgEBA0IABIX18y1okxcvuo0mdlIV24Qgju1j+S/EqGzcxdSgJR9/q19U4gCc37eTkLutntNIKrFNInXyDzuqdidB54pACK8=";
    
    public static void main(String[] args) throws InvalidKeyException, NoSuchAlgorithmException, SignatureException, IOException, KeyStoreException, CertificateException
    {
//        Certificate certificate = CAUtil.getCfeformPfxForSM2("G:\\PROJECTS\\CA_PROJECTS\\qianhai\\SZCAJavaCAS\\src\\cert\\pfx_cert\\sm2.pfx", "123456");
//        System.out.println(Base64.encodeBase64String(certificate.getEncoded()));
//        String signed = "29chvs2gRxwReZtYJfq5Q+694QpRwIdKC6xOd6gMiaICpjKpaf5xuJIRnqReJ5uHh0Dxlara8z10wQq9bPDleQ==";
//        ByteArrayInputStream inStream = new ByteArrayInputStream(CAUtil.base64decode(signed));
//        byte[] decode = Base64.decodeBase64(signed);
//        System.out.println("length:"+decode.length);
//        ASN1InputStream asnInputStream = new ASN1InputStream(inStream);
//        //MIJCQwYJKoZIhvcNAQcCoIJCNDCCQjACAQExDjAMBggqgRzPVQGDEQUAMII8NQYJKoZIhvcNAQcBoII8JgSCPCJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQVR3QUFBSFJDQVlBQUFEMzN3VmFBQUFnQUVsRVFWUjRYdTJkQ2N4VnhmbUhSM1lLQ2xnRW94V2hFTnRTeXhKb05Td0NJVlc2V0JCVXRxU0EwclFCVzVaaXFoUVFrRVlNUk1CYXRRc1ZZcXVRdEJYY3FsVExub0tOQWk2VkpsQkFhYXV5YjdLVTVkOTMvcjNYODkzdkx1ZWVPMmRtemozUEpBVGtPMmZlZDU3MzhIUFdkeTY2OE4raUtCQ0FBQVJTUU9BaUJDOEZVYWFKRUlDQUpvRGc4U0ZBQUFLcElZRGdwU2JVTkJRQ0VFRHcrQVlnQUlIVUVFRHdVaE5xR2dvQkNDQjRmQU1RZ0VCcUNDQjRxUWsxRFlVQUJCQTh2Z0VJUUNBMUJCQzgxSVNhaGtJQUFnZ2Uzd0FFSUpBYUFnaGVha0pOUXlFQUFRU1Bid0FDRUVnTkFRUXZOYUdtb1JDQUFJTEhOd0FCQ0tTR0FJS1htbERUVUFoQUFNSGpHNEFBQkZKREFNRkxUYWhwS0FRZ2dPRHhEVUFBQXFraGdPQ2xKdFEwRkFJUVFQRDRCaUFBZ2RRUVFQQlNFMm9hQ2dFSUlIaDhBeENBUUdvSUlIaXBDVFVOaFFBRUVEeStBUWhBSURVRUVMelVoSnFHUWdBQ0NCN2ZBQVFna0JvQ0NGNXFRazFESVFBQkJJOXZBQUlRU0EwQkJDODFvYWFoRUlBQWdzYzNBQUVJcElZQWdwZWFVTk5RQ0VBQXdlTWJnQUFFVWtNQXdVdE5xR2tvQkNDQTRQRU5RQUFDcVNHQTRLVW0xRFFVQWhCQThQZ0dJQUNCMUJCQThGSVRhaG9LQVFnZ2VId0RFSUJBYWdnZ2VLa0pOUTJGQUFRUVBMNEJDRUFnTlFRUXZOU0Vtb1pDQUFJSUh0OEFCQ0NRR2dJSVhtcENUVU1oQUFFRWoyOEFBaEJJRFFFRUx6V2hwcUVRZ0FDQ3h6Y0FBUWlraGdDQ2w1cFEwMUFJUUFEQjR4dUFBQVJTUXdEQlMwMm9hU2dFSUlEZzhRMUFBQUtwSVlEZ3BTYlVOQlFDRUVEdytBWWdBSUhVRUVEd1VoTnFHZ29CQ0NCNGZBTVFnRUJxQ0NCNHFRazFEWVVBQkJBOHZnRUlwSURBN3QyNzFjcVZLOVhodzRmVmhBa1RWUFBtelZQUTZ0cE5SUEJTR1hZYW5RWUM2OWV2VnpObXpGQi8rOXZmMUVjZmZaUnQ4b0lGQzlURWlSUFRnS0JXR3hHOFZJYWRSbGNyZ2ExYnQ2cWxTNWVxRlN0V0tPblY1U3NJWHJWR24zWkJJQVVFTXNQVjJiTm5xNE1IRCtadGNkT21UVlgvL3YzVjZOR2oxYUJCZzFKQUpYOFQ2ZUdsTnZRMFBJa0U5dXpabzE1NTVSVjEvUGh4dFgzN2R2WGlpeStxOTk1N0wyOVRMcm5rRXZXNXozMU9EUjgrWEUyYU5DbUp6VFh1TTRKbkhDa1ZRc0E4Z1RWcjFxaGYvdktYNnFtbm5pcGErVVVYWGFSNjlPaWhwa3laa3VxZVhDRklDSjc1YjVNYUlWQXhBZW5KclZxMVNvblEvZUVQZjFDblRwMHFXdWZBZ1FPMXdNbXZ0SzdBaG9HTzRJV2h4RE1RaUpuQW0yKytxWll0VzZiKy9lOS9xOWRlZTAydnJCWXFJbWk5ZS9kV0hUdDJWREkzOTYxdmZVdDE2dFFwWmcrcm8zb0VyenJpU0NzU1NDQ3oyUENMWC95aXFNQkowMlNvMnJkdlgvWFFRdytwTGwyNkpMQzFmcmlNNFBrUkI3eW9ZZ0lpYVBQbXpWTm56NTVWYmR1MjFadC9aZnRJMlBMWnozNVc3ZHk1TSt6alBGZUVBSUxINXdHQkdBaGs5c010V2JKRUMxeVljdm5sbDZ1aFE0ZXF4eDU3VEowNWN5YjdTcDA2ZGRTNWMrZkNWTUV6SlFnZ2VId2lFS2lRZ0FqYXRtM2I5QUtEL05xNGNhUDZ6My8rRTZyV3JsMjdxaC84NEFmWnhZWkhIMzFValI4L3ZzYTdsMTU2cVRwdzRFQ28rbmlvT0FFRWp5OEVBbVVRV0w1OHVWNHhsZmszRVRkWmJDaTAyVGRUN2RWWFg2MjZkKyt1YnIzMVZpVzlPRmwwS0RRUDE3Qmh3Mnp2cmx1M2JtckVpQkZxOHVUSlpYaklvOFVJSUhoOEh4QW9Ra0NHcG12WHJ0WGk5c2MvL2xHZFBuMDZGSy9NZnJnNWMrYm94WVl3Uld4SmowK0t2QzlDeWhhVE1PVENQNFBnaFdmRmsxVk9JRGcwbGRNTU1qUzljT0ZDcUZhM2J0MWFEUnMyVFBmY1JPQmtjYUxjOHNBREQ2aXBVNmZxMTNyMjdLazJiTmhRYmhVOFg0SUFnc2Nua21vQ0luS1BQLzY0K3NsUGZxS1BhNVVxalJvMVVqSkV6WWliQ0p1cGJTSnQyclJSNzcvL3ZuYmhpU2VlME9kZUtXWUpJSGhtZVZKYlFnaklFRld5aXNncWFyRlNyMTQ5ZGVPTk42cmJicnN0Y3M4dExKTDY5ZXZyclN0U1pCR0V6Y1JoeVlWL0RzRUx6NG9uRTA0ZzA1dTc3Nzc3YW16N0NEYnJtbXV1VVYvNzJ0Y3FHcHBHd1JTY3YydlpzcVhhdDI5ZmxHcDRoeUV0MzBEYUNVait0MWRmZlZXOThNSUxlVkYwN3R4Wko4UjBlUTUxN05peGF2SGl4ZG8veVhBaW1WQW81Z25Rd3pQUGxCbzlJQ0RiUm1USUtrZXhqaDQ5V3NzaldRVWRQSGl3bWpadG1yRTV1RXFhTGVkaG4zdnVPVjJGcEhNcWxSV2xFbHRwZmhmQlMzUDBxNnp0TW1TVjRhcGtHU25VUStyVHA0OWVEUEJ0UVVBV1B5UkRpcFF0VzdaNEljSlY5bm5vNWlCNDFSalZsTFZKRmg3a2docEphNTZ2eU1KRHYzNzlsSnhwamJKZEpHNmMwaHR0MTY2ZE5uUHh4UmZuN1pIRzdVTmE2a2Z3MGhMcEttaG5aaE93OU9UazEvUFBQNjhQMVJmYUt5YzU0cEtRMHZ5ZWUrNVJEejc0b0k0UTgzZnhmcWdJWHJ4OHFiMU1BbkpVU3piOFNtOXM3OTY5cWttVEpqcUZlZGdOd0ZkY2NZV1NZYXVjU1UzS0tZV1JJMGRtNSt4RXBBdjFWTXRFeWVONUNDQjRmQlpPQ0VodlRlYXNaRGlhU1gzMDFsdHZSZkpGa21EZWYvLzllcFhWeHlGcnFVYkp5UXc1dmlabDllclZvWStpbGFxWG45Y21nT0R4VlZnaGtNa0pKeWNWM243NzdVZzJMN3ZzTXAyRlJNNmIzbkRERGRtTndFa1V1U0FBV1RIT2xFT0hEaVdtWnhvcGlJNWZRdkFjQjZDYXpjczhtMndOV2Jod1ljRTdVblBiTHdzTTdkdTNWN2ZmZnJ0T1lTN1pSY0lldms4aXkrQ0dZem15VnVndTJTUzJ6VWVmRVR3Zm81SnduOEljMjVKLzNOSXpFMEdUM3djTUdGRFZ3bFlvcE1FRkMrbTV2dkhHR3dtUHZ0L3VJM2greHlkUjNra2l5eWVmZkRKdmhsKzVJMVdHb2QvOTduZFZyMTY5R0xiOUw3TENRaFpwcE54MDAwM3FwWmRlU2xUTWsrWXNncGUwaUhub3J5dzgzSDMzM1dyLy92MjF2UE4xbzY4dkdDWFRpaVFLa0NJbkxiNzV6Vy82NGxwVitvSGdWV1ZZN1RSS2hHN1dyRm0xNXAxa1lVTHVacER6cWFaU0o5bHBrVjByTXNmWm9rV0xyTkd3VzIvc2VsbGQxaEM4Nm9xbmxkWVVFcnJHalJ2cmxPVHo1ODlueUJvaUVqTFhLU2RBcEVnQ2czSnVNZ3RSUFkva0lZRGc4Vm1FSmxCSTZKbzFhNlo3Yy9JcktadDlRemM2eGdkbnpweXBlOGhTSmt5WW9GZXpLZkVTUVBEaTVWc1Z0YytlUFZ0SituRzV2Q1pZRUxyS3dodmNjRXlHNDhwWWhuMGJ3UXRMS21YUHlmelNva1dMZEs4ajkxNVZoTTdNeDlDZ1FZUHNkWTY3ZHUxSzVDa1JNeVRzMVlMZzJXT2RDRXV5OFZXR1dmbFNuOWV0VzFkTm1USkZ5ZDR4aHE2VmhUT1lJVVc0WmxLN1YxWXJiNWNpZ09DVklwU1NuOHNFdXZUbzhoMWNsMDNDc2wxQ3RwN0lueW1WRXdndVdNakpraDA3ZGxSZUtUV1VKSURnbFVSVTNROUlUMDZFTHQ4S0lYdm80b3Q5VVBDRXMvdzNKWDRDQ0Y3OGpMMnpVT3FNcTZRb2toWFhhajdENmpvbzhqK2FNV1BHYURkR2pScFY4dlkwMS81V2kzMEVyMW9pR2FJZE1tOGtpU1ovL3ZPZjE4b3ZKd3NSa2w1SnRrb2tQZnRJQ0JUT0h3bHVTWkcwOVBMZmxQZ0pJSGp4TTNadW9kaENCQ3V1YnNLRDRMbmhqdUM1NFc3RmFyR0ZDTmtTSWRjWGpoczN6b292R0tsSlFGTFBTK29zS2V6QnMvZDFJSGoyV0Z1ekpDdXRzaENSYnlKY0pzZ3pkN0JhY3doRHRRaVE1ZGpOUjRIZ3VlRWVpOVZDUjcvRUdBc1JzU0NQWEtua0Fmend3dy8xKzZSMWo0eXg3QmNSdkxLUitmV0N6TS85K01jLzFyMjVmLzNyWDdXY2t4VkFGaUw4aXBsNFU3OSsvZXhtWTA1WjJJc1BnbWVQdFRGTHNtY3VjdzlydnYxem1ZVUltU2RpeGRVWWRxTVZCZSt4SUMyVVViUkZLMFB3N0xHdXlKTE15OG5OVnZKN29Yc1A1QlNFaUJ4WlM4cER2WDc5ZXZYcXE2K3F3WU1IcTA2ZE9wWDNjb1NuZy9kWWtCWXFBc0FLWGtId0tvQVg1NnR5aGFFTVUwWGc1UGZjQS94QjJ5MWJ0bFIzM25tbm1qdDNicHd1VlUzZGN2ZXREUFBsdmxzUm4zUG56bVhidG5qeFluWEhIWGZFMmxaT1djU0tseDZlTzd6bFc1YUZoNS8rOUtkRkwzUEpiQktXbFQ3WkxNeEIvbkNjTXhsZ2ltM3lsYnMzamh3NUVxN0NpRStSQnk4aU9BT3YwY016QUxIU0txU1hrVG00WDZnbko4TlZFVGY1eFpHdjhva1h1MkFvV052WHYvNTE5Y0lMTDVSdm9JdzMySFJjQml6RGp5SjRob0dXcWs0RVRTNXRrV0dOQ0ozODQ1TExwZk9WSzYrOFVxZGpFcEZqOGFFVTJmdy9seDd6OU9uVDFkNjllMnM4MExwMWEvWHRiMzliUGY3NDQrcllzV1A2WnpmZmZMTjY5dGxub3hrcTR5MzI0SlVCeS9DakNKNWhvTUhxUktUa0g1cWNhcEI1dHZmZmY3K2t0Y3pDQXl1c0pWRVZmVUJPa1V5ZE9yVldsdWFHRFJ0cWtSTys4ajhTV2UyV0l0emxmMEEycGdlQ041V3hCNit5T0pmN05vSlhMckdRendlUERwVjZSYllvOU9qUlE4MlpNNGZoYWlsWUpYNHVQV2pKUXBLYjE2OUpreWI2UHR4bHk1WnBVUk5CbkR4NWNyWTJtOExEbHBRS2cxekI2d2hlQmZDS3ZUcHAwcVNDbDdMMDdObFRkZS9lWFY5aG1Qa1ZreHVwcWxhR3I4STlPQThxMllTblRadFdZNnVPL0x4VnExYlpxUVJiUTFrSlJ2QnF4bnIxNmhXY3praFY0Q3cyRnNHTEViYk0xY2d1K3R0dnYxMk5IRG1TTzFwallpMzdFcVZYbDN0MldMSTBQL0xJSTdXeU5BZUhzdExiT25qd29KV2hyRFEvdUNWRjVoRS8rT0NEbUtoUWJUNENDQjdmUmFJSjNIWFhYZXJKSjU5VVI0OGV6YlpENXVPa3Q1ZHZOVnN1SlpKZVlLWTg5OXh6T24yOXJSSzBUK0pQVzlRL3NZUGcyV2VPUlFNRXBLY2tQZWQ5Ky9iVnFFMlNhUlk2YVNJOXdhNWR1MmFIdkM3dWdoWGZaQXVTRkJKL0d2Z1F5cXdDd1NzVEdJKzdKU0J6WU5KRHk3MVY3WnBycmxITGx5OHZPbTBRekZEaTZrZ1hXMUxjZmo4SW5sditXQytEZ0F3SDVRcko0S0tFVFB4LzR4dmZ5SHZiV3JCcVdaaDQvdm5uczMrMVpjc1dKM09xc2tLY09jbEJscFF5Z20vb1VRVFBFRWlxaVkrQTdJK1RYbDN1b29UaytCTVJMTFVwTzNoaGpuZ3BaMlhsekt6dEVseWhGZHRrU2JFZEFhVVFQUHZNc1JpU2dDUlFrRngvdi8zdGIydThVV3hSSXJkcUVjdCsvZnBsZTRVeWgvZkdHMitFOU1Ec1l5UU5NTXN6U20wSVhoUnF2Qk1yQVZsY2tKdlY1czJiVnlPVGlSZ3RaNkpmZWxRaWRwbWNnVEp2SjZKajR6UkZQa0NzME1iNjJZU3FITUVMaFltSGJCRElKRkhJWFpBUTIzSVhoL3g5cWVGcjBNL2dmanZKTUNOaUp4dTlYUlZXYUYyUi84UXVndWMrQnFuM1FJUklGaVB5WFRvazU1QWx6MTl3NzF3WVlDTkdqRkJQUC8xMDlsRWZiZ1pqaFRaTTVPSjlCc0dMbHkrMUZ5RlE3TktoU201WEM4NlZpZm52ZmU5NzZySEhIbk1laTBhTkdxblRwMDlyUDFpaGRSTU9CTThOOTlSYWxYbTFlKys5Vi8zcVY3L0tYbUlUaENHbkR5VHhRdFNjZjdtYmkyVys3dENoUTg1NXMwTHJQQVRhQVFUUGp6aFV2UmZGNXVka2ZpMXpGMGM1YzNUNW9BVlRMMG05SW9DdUZpbUMva24ybGx0dXVVWC9GV2RvM1gzdUNKNDc5cW13TE1QV3BVdVhGcHlmazdtNWUrNjV4NGdvNWFia2NyVzVPRjlnU2V2dXgrZU80UGtSaDZyeVFpN0prVVdDUWplc3lmeWNuSU1kTjI2Y3NYYm5iaTcyWVpFaTJMamdnc1V6enp5ams0OVM3Qk5BOE93enIxcUxNbnlVQS9tRjBxVEwvSnhzelRDOU5lVEZGMS9VeDhzeXhjY3NKQndwOCtPelIvRDhpRU9pdlJDaGsyMGwrZmJQeFgxWHJpd0dTRktBek9ybkZWZGNvZDU1NXgwalEyUlRRUkUrN2RxMTA5WEp2R0t4S3pkTjJhU2UvQVFRUEw2TVNBUTJiTmlnM25yckxmWFFRdytwSFR0MjFLcEQ3dkFRRVRRNWJNM25hSENvV0tkT0hYMVp1YVJ5OTZrRWg5c3luTSszMzlBbmY2dlpGd1N2bXFNYlU5dXV2ZlphM1l2S1YrUWZ0RXpRUjkxV1VvN0x3Wk1MOHA3TmV5bWkrbG5PMGJoeWJQQnNPQUlJWGpoT1BQVS9BZ01HREZBdnYveHlMUjdkdW5WVDgrZlB0eUowWWp5NHpVUCsyMmNoWWNIQ24zOCtDSjQvc1VpRUo3SlBUcktZU0xuMDBrdDFxaVZKMDJSekdMbCsvWHAxNDQwM1pxOWdGUHU1dDVUNUJETjRTNWxzZ3ZaaFg2QlBmR3o2Z3VEWnBGMEZ0dHEwYVpPOVgxZk9xZzRiTnN4cXEyVENYMFEzazBUenFxdXVVcklOeGxjUmtRM1hrcEpLaWl6Z3lBSUd4UjBCQk04ZCswUmF2djc2NjlYbXpadTE3MU9tVE5FcG5HeVc0T1ppNlRsSmJqdlQyMXhNdG1mMjdObDZ1QzNscTEvOXFscTFhcFhKNnFtclRBSUlYcG5BMHY1NDhMN2RvVU9INm91dGJaWGN6Y1d5Q2p4anhneGI1aVBaQ1I1MUd6OSt2TDQya3VLT0FJTG5qbjBpTGMrWk0wZE5uejVkK3k3RHlmZmVlODlLTzNJekYvdTR1VGdmaUtaTm02b1RKMDdvSDYxYnQwNzE3dDNiQ2krTTVDZUE0UEZsbEVVZ21Icko1czFmbDExMm1kcS9mNy8yMVhYbTRyREFndk4zYkRnT1N5M2U1eEM4ZVBsV1hlMUJ3Wk1Gak15S2Jad05EZDQ0MXJCaFE3VnAweWF2NSsweUxFanBIdWRYRWExdUJDOGF0MVMvbGRsbUliK2ZQMzgrVmhhNXlUenZ2UE5PblVzdkNTVzQvODYzWkFaSjRCZUhqd2hlSEZTcnZFNjVDL2JjdVhPNmxYR21ZSkl0S0hJR05YUDJWQVJFVGxNa29lUW0vR1QvblI5UlEvRDhpRU9pdkFoZWpyTmd3UUtkQVNXTzhxVXZmVW05L2ZiYnVtcWZrbm1HYVd2d0pJak51YzR3dnFYNUdRUXZ6ZEdQMlBiZzNOUk5OOTJrWG5ycHBZZzFGWDd0cnJ2dVVqLzcyYyt5RC9oNlRyWlFDNEw3QlgwKzltWThjSjVYaU9CNUhpQWYzUXV1UHNyRk5DZFBualRxWnJCK3FmaUdHMjdRV1ZDU1ZJSkg4SkltMWtuaVhLNnZDRjY1eEhoZUU2aGJ0MjUyd2NMa0RWd3k5eVZIc1RKSHNDUy8zVC8vK2M5RVVTZi9uYi9oUXZEOGpZM1hua21HWWNrMExFV09sOGt4TXhPbFE0Y09hdWZPbmJvcW1iZVQzbDZsRi91WThLdWNPb0pEZnQ4VEc1VFRybXA0RnNHcmhpZzZhRU53amszeTQwa3kwRXFMSkNKWXZueDV0cHFrM3YwUVhOUmhPMHFsWDRYWjl4RThzenhUVTF2d0hna1ozcDQ5ZTdhaXR1ZnV0MHR5enlpWURzcmtjTDhpd0x5c0NTQjRmQWlSQ0p3NmRVbzFidHc0KzY0c1hNZ0NScFFpYzE2eWRlUG8wYVA2OWZidDIrZE5HeCtsYnR2dnlKV1REejc0b0RZcjUyaVBIVHRtMndYc0ZTR0E0UEY1UkNZd2N1UklQWTgzZVBCZ3RYang0a2oxeUNLRkpDRTRmdnk0Zmo5cCsrMXlHeTJKVURkdTNLai8yblkybVVnQlNObExDRjdLQXU1YmN5Vno4Wi8rOUtlc1czR2UzSWk3N2NIVldiSEZjRFp1NHVYWGorQ1Z6NHczREJFSUpoT1ZLci8vL2Urcmh4OSsyRkR0OXFzSlhpcVU1RGxJKytUc1dVVHc3TEhHVW9CQTd1WFpjb0czYk9kSWNnbGV0cDNVRmVZazh3L2pPNElYaGhMUEdDZHc5OTEzNjF2T3BOaE1KR3E4SWYrck1KaU5tYnNyNHFKY2ViMElYdVVNcVNFQ0FibW8rOENCQS9wTmt4dVhJN2hpNUpWZ0txZzRFeW9ZY1RiRmxTQjRLUTYreTZiWHFWTkhYYmh3UWJ1d2JkczIxYWxUSjVmdVZHUTdkN0dDVkZBVjRZejFaUVF2VnJ4VVhvaEFjSE51cTFhdDFJY2ZmcGhZV01ITUtFbTVheU94c0N0MEhNR3JFQ0N2bDA4Z2Q5TnkvZnIxMVprelo4cXZ5SU0zY3BPVWtobkZnNkFVY1FIQjh6cytWZXRkOSs3ZDFldXZ2NjdiOThNZi9qQzdnSkcwQnJOWWtheUlJWGpKaWhmZWVrWWdlTzhzaXhXZUJTZVBPd2llL3pIQ1EwOEo1Q1lxWmJIQzAwQUYzRUx3L0k4UkhucEtJSmpoaGNVS1Q0T1U0eGFDbDR3NDRhV25CR2JPbkttVGxNcGNucHkwb1BoTkFNSHpPejU0QndFSUdDU0E0Qm1FU1ZVUWdJRGZCQkE4ditPRGR4Q0FnRUVDQ0o1Qm1GUUZBUWo0VFFEQjh6cytlQWNCQ0Jna2dPQVpoRWxWRUlDQTN3UVFQTC9qZzNjUWdJQkJBZ2llUVpoVUJRRUkrRTBBd2ZNN1BuZ0hBUWdZSklEZ0dZUkpWUkNBZ044RUVEeS80NE4zRUlDQVFRSUlua0dZVkFVQkNQaE5BTUh6T3o1NEJ3RUlHQ1NBNEJtRVNWVVFnSURmQkJBOHYrT0RkeENBZ0VFQ0NKNUJtRlFGQVFqNFRRREI4enMrZUFjQkNCZ2tnT0FaaEVsVkVJQ0Ezd1FRUEwvamczY1FnSUJCQWdpZVFaaFVCUUVJK0UwQXdmTTdQbmdIQVFnWUpJRGdHWVJKVlJDQWdOOEVFRHkvNDROM0VJQ0FRUUlJbmtHWVZBVUJDUGhOQU1Iek96NTRCd0VJR0NTQTRCbUVTVlVRZ0lEZkJCQTh2K09EZHhDQWdFRUNDSjVCbUZRRkFRajRUUURCOHpzK2VBY0JDQmdrZ09BWmhFbFZFSUNBM3dRUVBML2pnM2NRZ0lCQkFnaWVRWmhVQlFFSStFMEF3Zk03UG5nSEFRZ1lKSURnR1lSSlZSQ0FnTjhFRUR5LzQ0TjNFSUNBUVFJSW5rR1lWQVVCQ1BoTkFNSHpPejU0QndFSUdDU0E0Qm1FU1ZVUWdJRGZCQkE4ditPVEN1ODJiTmlnMXExYnA2Wk9uWnFLOXRKSWR3UVFQSGZzVTI5NXo1NDlxbHUzYnVyQWdRT2FSWmN1WGRTV0xWdFN6d1VBOFJGQThPSmpTODBsQ054NjY2M3E5Ny8vZmZhcGxpMWJxbjM3OXNFTkFyRVJRUEJpUTB2RnhRaXNXYk5HOWV2WHI4WWpUei85dEJvMmJCamdJQkFiQVFRdk5yUlVYSWpBNGNPSFZkZXVYZFh1M2J1emovVHAwMGVKQ0ZJZ0VDY0JCQzlPdXRTZGw4REVpUlBWb2tXTDZOM3hmVmduZ09CWlI1NXVnL21Hc2dNSERsUXJWcXhJTnhoYWI0VUFnbWNGTTBhRWdBeGxyN3p5U3ZYeHh4OW5nWXdhTlVvdFdiSUVRQkN3UWdEQnM0STVYaVBTYTFxN2RxMlNlYkMrZmZ2R2E2eUMyanQyN0tqZWZmZmRiQTM5Ky9kWHI3enlTZ1UxOGlvRXlpT0E0SlhIeTh1bjI3WnRxMlJQVy9QbXpkV2hRNGU4OUhIMDZORnE2ZEtsV2Q4YU5XcWtUcDQ4NmFXdk9GVzlCQkM4S29qdFJSZGRsRzNGaFFzWHZHdFJydGlKZzZ0WHIvYTZOK29kUkJ3eVFnREJNNExSYlNVK0MxNCtzV1BlenUzM2ttYnJDRjRWUk45WHdjc25kczJhTlZOYnQyNVZNZ3luUU1BMkFRVFBOdkVZN1Brb2VQbkVUcHArMzMzM3Faa3paOFpBZ1NvaFVKb0FnbGVha2RkUEJQZTFkZTdjV2ZlZVhKZENZdGUwYVZOMTdOZ3gxKzVoUDhVRUVMeUVCejhvZUQ0Y3o4b1Z1d1lOR3Fnelo4NW95ck5telZJelpzeElPSEhjVHpJQkJDL0owZnV2N3o0SlhxN1k5ZXpaVTIzY3VGRVR2dnJxcTJ1Y25VMDRkdHhQS0FFRUw2R0J5N2k5Y09GQ05XblNKUDJmTGxjL2M4Vk9mQkV4bHYyQlVoWXNXS0RrREMwRkFpNEpJSGd1NlJ1d0xRc0FNbFNVNG1wQklKL1lEUm8wU04xeXl5M2FMMW1abGN3b3NqR2FBZ0dYQkJBOGwvUU4yQTVtSHZuUmozNms1czZkYTZEVzhGWGtFenM1R3l0SDNPUzRtMHNoRHQ4S25rd0xBUVF2NFpHV3RPamJ0bTNUclJnL2ZyeDY1SkZIckxXb2tOamxaa1RadFdzWCsrNnNSUVZEeFFnZ2VBbi9QcTY5OWxyMXpqdnY2RmJZekJoY1NPekVqMkNTQUpmemlna1BMZTdIUUFEQml3R3F6U296aVFQRXBxMmVWREd4azdtNmR1M2FaUkhZOHNrbWMyd2xsd0NDbDl6WWFjOXRuN0lJRHFIRmZtNFBMcmlJd2xhVWhIOWNWZWcrZ3BmZ29NcXBDcmtiUW9vTmNSa3dZSUI2K2VXWHM4VHlEVmVEUGM0bm5uaENTVytRQWdGZkNDQjR2a1FpZ2g4Mk54MEg5L3VKcTdLcFdDN1FEaFpKMHg3Y2lpSVpqaWtROElrQWd1ZFROTXIwSlRoOG5EQmhnaEpSaXFQSU5wTXhZOFprcTg0bmR2SkQyWHUzY3VWSy9WeWMvc1RSUnVwTUJ3RUVMOEZ4dHJIcE9GZnNDaVVvWUxFaXdSOVNpbHhIOEJJYzdPQ1dsRGd5Q0FlSHFJSkp4RTZHMGZsT1RBUTNRUHVReENEQlljWDFHQWtnZURIQ2pidnF4bzBicTFPblRta3pwZ1ZQRmtUNjlldW5ieG9ySlhieTgvcjE2NnV6WjgvcVoxbXNpRHZ5MUIrVkFJSVhsWnpqOTBTSVdyUm9rZlhDNUYwVzVZcGRjUEZFdHNtY1AzL2VNUjNNUXlBL0FRUXZvVjlHY0xocGNnaVpLM1p5OEY4RVRmYmZGU3JCamNnMzMzeXpldmJaWnhOS0ZiZXJuUUNDbDlBSUIrZk1UR1ZKa1Y2am5KTElER1BEaUozZ2t6bTlJMGVPYUpKYnRtd3BLbzRKeFkzYlZVSUF3VXRvSUlNbkhrek0zNG5JeVp4ZEprVjhXTEVMOWpSdGJINU9hTGh3MnhNQ0NKNG5nU2pIRGRQemQ3bGlWMDVQTFRpY1plOWRPVkhrV1JjRUVEd1gxQ3UwYVhMK0xwL1loVjFselJWZWhyTVZCcGJYWXllQTRNV08yTHdCay9OM3dkTVI0bWxZc1pObmc1dVNmYmt4elR4dGFxd21BZ2hlQXFOcGF2NHVOODFUT1dJbjJENy8rYytydi8vOTc1b2dkMVlrOEVOS29jc0lYc0tDbmp1TVBIVG9VS1M3SW5MRnJ0eVYzbHcveUh1WHNBOHBwZTRpZUFrTGZIRCtMdW93c2xnQ3o3QTRnc05aV2RFbE0wcFljanpua2dDQzU1SitCTnZCK2Jzb3E2SzV5UUNpcG1BUGlpYkQyUWlCNUJVbkJCQThKOWlqRyszUW9ZUGF1WE9ucnVDWlo1N1JLWm5DRmxOaUovYlliQnlXT3MvNVJBREI4eWthSlh5cFpQNHViSnFuTURpQ1oyZlpiQnlHR00vNFFnREI4eVVTSWZ3SXp0OUpEMHNXTE1LVWN0SThoYWt2T0t5T09pUU9ZNGRuSUdDYUFJSm5tbWlNOVFXRlJqSVEvL3JYdnk1cHJkek1KeVVyL084RHdXMHg1UTZydzlUUE14Q0lpd0NDRnhmWkdPb3RWMmppRUx2Y3pNWW0wMUxGZ0l3cUlWQ0RBSUtYa0EraTNQT3pVZEk4aFVFeFlzUUlmZUczbEw1OSsrckVveFFJSklVQWdwZVFTSlZ6Zm5iUG5qMnFmZnYyNnR5NWM3cDFZVE9maEVGeC9mWFhxODJiTit0SGh3OGZycDU2NnFrd3IvRU1CTHdnZ09CNUVZYlNUZ1QzdlpVNkZmR1ZyM3hGL2ZXdmY5V1ZObXJVU1AzbEwzOHhscU91VjY5ZWF1UEdqYnB1RTJtcFNyZWNKeUJnamdDQ1o0NWxyRFVGTDdndUpqUzVjMnpMbGkxVFE0Y09OZWFiREdQWHJsMkw0QmtqU2tVMkNTQjRObWxIdEZYT1FrRXcrOGwxMTEybk5tM2FGTkZxL3RjUVBLTTRxY3d5QVFUUE12QW81b0tiaGdjT0hLaGtQaTlmQ1c0SWxwL0hrWi91VTUvNmxEcDU4cVEySHpWeFFSUUd2QU1CRXdRUVBCTVVZNjRqN0xuVllPOHJyZzNCY2l0WnBzZ3hOeWxObXpiVnFlRmwyNHdNdC9QZFd4c3pJcXFIUUNnQ0NGNG9URzRmQ3M3ZkZlcTE1ZmJ1NGtyWEpPSjI0c1NKZ2tCWXlIRDdyV0M5T0FFRXovTXZSSHBPWGJ0MjFWNFdTOE5rbzNjblBnUzNwZVNpaytzaVpiaE5EOC96anlyRjdpRjRuZ2QvNGNLRmF0S2tTZHJMUXZOM3VXZGw0K3JkaVE4Yk5teFF0OTEybTJyZHVyWDY4cGUvclByMzc2OHpIeGU3dDlaenhMaVhJZ0lJbnVmQmxnM0UvL2pIUDdTWGhmTE9CWWU4cGZib2VkNWMzSU5BckFRUXZGanhWbDU1L2ZyMTFkbXpaM1ZGK2VidmNqTVB5eFlXaHBTVmM2ZUc2aVNBNEhrYzErQkNSS0g1TzNwM0hnY1ExN3dqZ09CNUY1SlBIQ3FWenAzZW5jZkJ3elV2Q1NCNFhvYmwvNTBLOXQ1eTg4NUo5aFJadlpVaHJCVG03andPSks1NVF3REI4eVlVTlIwSkhpZkxONXlkT1hPbW1qVnJsbjVKMHF6TDloWG03andOSm01NVF3REI4eVlVTlIwcHRoMUZlbmZ0MnJYTFhvMVk3Z1hhbmpZWnR5QVFPd0VFTDNiRTBRd0Vrd0RrQ2xwdTd5NHpySTFtaWJjZ2tCNENDSjZIc2M3TmJoemNTRXp2enNPQTRWSmlDQ0I0SG9ZcWVIS2ljK2ZPZW40dVU0SXJ0MXlSNkdId2NNbHJBZ2llaCtFcGxOMDROeThlQi9VOURCNHVlVTBBd2ZNd1BJV3lvd1NGVUE3cXk4WmtDZ1FnRUo0QWdoZWVsWlVuQzJWSG9YZG5CVDlHcXB3QWd1ZFpnSWNORzZhV0wxK3V2UXJlQ2tidnpyTkE0YjZlSVFzQUFBekNTVVJCVkU0aUNTQjRub1h0NG9zdlZzZVBIOWRlM1gvLy9XcmF0R2w2MFNLVEUwLytucms3ejRLR080a2hnT0I1RktyY1lXdm16b2hnY3M5aWQxcDQxQlJjZ1lDWEJCQThqOEtTNzNTRnJkVHRIbUhBRlFqRVJnREJpdzF0K1JWTDF1QnQyN2JwRnpPbksyeWxiaS9mVzk2QVFQSUlJSGlleEN6ZmNQWjN2L3VkK3M1M3ZwUDFNTTdVN1o1Z3dBMEl4RW9Bd1lzVmIvaks4dzFuSmZ2SmtTTkhkQ1ZEaGd4UklvQVVDRUFnT2dFRUx6bzdvMi9tSmd1UU03T1p5M3ZrTHRpREJ3K1Mvc2tvY1NwTEl3RUV6NE9vNXlZTGtPR3R6T2ZKMzB1Wk1HR0NraDRnQlFJUXFJd0FnbGNaUHlOdkIxTzFTN0lBV2FoWXRHaVJycHNFQVVZUVV3a0VOQUVFejRNUDRicnJybE92dmZhYTltVEtsQ2xxL3Z6NVdhOXlVN3Q3NEM0dVFDQ3hCQkE4eDZITEhjNksrRzNldkZsN1JZSUF4OEhCZk5VUlFQQWNoelE0bkczU3BJazZjZUpFMWlPMm9UZ09EdWFyamdDQzV6aWt3ZFhaRmkxYUtEbE9Kb1ZieUJ3SEJ2TlZTUURCY3hqVzNPRnN4aFc1cFV4V2FybUZ6R0Z3TUYyVkJCQThoMkVORG1lRGJuQUxtY09nWUxxcUNTQjREc01iekhHWGNZT0ZDb2NCd1hUVkUwRHdISWE0VWFORzZ2VHAwelU4SU5lZHc0Qmd1dW9KSUhpT1FqeG56aHcxZmZyMEd0WkhqUnFsWkpoTGdRQUU0aUdBNE1YRHRXU3RkOXh4aDA0QmxTbVhYSEtKMnJObkR3c1ZKY254QUFTaUUwRHdvck9yNk0yT0hUdXFkOTk5TjF1SG5MQ1lOMjllUlhYeU1nUWdVSndBZ3VmZ0M4bmRqaUs5dTB3YUtBZnVZQklDcVNHQTREa0k5Zmp4NDlXamp6NmF0Y3hDaFlNZ1lES1ZCQkE4QjJHdlY2K2VPbmZ1bkxiY3NtVkx0Vy9mUGdkZVlCSUM2U09BNEZtT2VlL2V2ZFdHRFJ1eVZ1WFBQWHYydE93RjVpQ1FUZ0lJbnVXNGQralFRZTNjdVZOYmJkT21qVjZacFVBQUFuWUlJSGgyT0dldFBQend3enFEc2FSdFg3ZHVuZXJWcTVkbER6QUhnZlFTUVBBY3hWNVdha2tPNEFnK1psTkxBTUZMYmVocE9BVFNSd0RCUzEvTXE2N0YwbHRldVhLbEdqaHdJTDNtcW91dTJRWWhlR1o1VXB0RkFpSjB3NGNQVjJ2WHJsVW5UNTdVbHgvSm5rWUtCQW9SUVBENE5oSkpRSzZ0bkRwMXFoYTZUSkhFcVptckxSUFpLSnlPblFDQ0Z6dGlESmdrc0diTkduMUIrZGF0VzJ0VSs4VXZmbEg5NWplLzBmZjVVaUJBRDQ5dklORUUzbnp6VFRWMDZGQzFmZnYyR3UyUWUwQW1UNTZzcGsyYmx1ajI0YndkQXZUdzdIREdTa1FDY3JmSHJGbXphdVVKbE9IcnhJa1QxY3laTXlQV3pHdHBKSURncFRIcUNXaHpJYUVUMTRjTUdhSXZLMi9idG0wQ1dvS0xQaEZBOEh5S0JyN28yOXJ5OWVnRXpkVlhYNjJIcm1QSGpvVVVCQ0lSUVBBaVllTWwwd1NLQ1oxY2JDUkRWOWwyUW9GQUpRUVF2RXJvOFc3RkJHUWJpU3hHckZxMXFsWmRDRjNGZUtrZ2h3Q0N4eWZoaElBSTNhSkZpNVRzcDh2ZE80ZlFPUWxKS293aWVLa0lzMStObEp2WlpKNU9ockhCMHJwMWE3VnMyVEtHcm42RnE2cThRZkNxS3B4K04wWTJEWThaTTZhVzBMRVk0WGZjcXNrN0JLK2FvdWxwVzVZdlg2NVhWM2ZzMkZIRFF4RTZXWXdZUFhxMHA1N2pWclVSUVBDcUxhSWV0VWQ2ZFBmZWU2L2F0R2xURGE4eW00Wmw0ekE1QVQwS1dBcGNRZkJTRUdUYlRSU2hrems2K1QyM1NMWm42ZFVoZExhamdqMGhnT0R4SFJnalVFem92dkNGTCtnRmlVNmRPaG16UjBVUUtKY0FnbGN1TVo2dlJVQldYV1dMU1c0R0UzbHcxS2hSdWtmSE1UQStIQjhJSUhnK1JDR2hQaFRhWG9MUUpUU2dLWEFid1V0QmtFMDNzWkRRc1JoaG1qVDFtU2FBNEprbVdzWDF6WjQ5V3ozd3dBUHExS2xUTlZxSjBGVngwS3VzYVFoZWxRVTBydWJJRmhLWnB3c1doQzR1MnRRYkZ3RUVMeTZ5VlZhdkxEeklWaE1wZGV2VzFSdUoyVWRYWlVGT1FYTVF2QlFFMlVRVDVZRC91SEhqVklNR0RiVHd5U2tKQ2dTU1JnREJTMXJFOEJjQ0VJaE1BTUdMakk0WElRQ0JwQkZBOEpJV01meUZBQVFpRTBEd0lxUGpSUWhBSUdrRUVMeWtSUXgvSVFDQnlBUVF2TWpvZUJFQ0VFZ2FBUVF2YVJIRFh3aEFJRElCQkM4eU9sNkVBQVNTUmdEQlMxckU4QmNDRUloTUFNR0xqSTRYSVFDQnBCRkE4SklXTWZ5RkFBUWlFMER3SXFQalJRaEFJR2tFRUx5a1JReC9JUUNCeUFRUXZNam9lQkVDRUVnYUFRUXZhUkhEWHdoQUlESUJCQzh5T2w2RUFBU1NSZ0RCUzFyRThCY0NFSWhNQU1HTGpJNFhJUUNCcEJGQThKSVdNZnlGQUFRaUUwRHdJcVBqUlFoQUlHa0VFTHlrUlF4L0lRQ0J5QVFRdk1qb2VCRUNFRWdhQVFRdmFSSERYd2hBSURJQkJDOHlPbDZFQUFTU1JnREJTMXJFOEJjQ0VJaE1BTUdMakk0WElRQ0JwQkZBOEpJV01meUZBQVFpRTBEd0lxUGpSUWhBSUdrRUVMeWtSUXgvSVFDQnlBUVF2TWpvZUJFQ0VFZ2FBUVF2YVJIRFh3aEFJRElCQkM4eU9sNkVBQVNTUmdEQlMxckU4QmNDRUloTUFNR0xqSTRYSVFDQnBCRkE4SklXTWZ5RkFBUWlFMER3SXFQalJRaEFJR2tFRUx5a1JReC9JUUNCeUFRUXZNam9lQkVDRUVnYUFRUXZhUkhEWHdoQUlESUJCQzh5dXNJdkhqaHdRSDM2MDUrT29XYXFoQUFFS2lHQTRGVkNMOCs3VjExMWxkcTdkNi8reWNDQkE5V0tGU3NNVzZBNkNFQWdLZ0VFTHlxNUF1L1ZyVnRYblQ5L1B2dlRkdTNhcWFsVHA2cXhZOGNhdGtSMUVJQkF1UVFRdkhLSmxYaStiZHUyYXMrZVBiV2VhdFdxbFJvM2Jwd2FOV3FVa21lU1ZIYnYzcTNiSkw5Mzd0eFpkZW5TSlVudTR5c0VzZ1FRdkJnK0JoR0dKVXVXcUxsejU2clRwMC9Yc3RDOWUzZlZvMGNQTlduU0pDL0ViK3ZXcmVyMTExOVhaODZjVVI5OTlKRVd0dUN2M0FiczJyWExDNzlqQ0IxVlZqa0JCQy9HQUI4K2ZGajE3ZHRYYmQrK1BhL3daVXpMTTlKcmtsOG1lbEJpZDl1MmJicDYrYk1JbXBTTWlNbWY1ZS9rWjFISzZ0V3JkYnNvRUVnYUFRVFBVc1NreHljTEdDdFhyb3hrVWNTd2VmUG10ZDdkdjMrLyt1Q0REOVJuUHZPWnJMQkZNbERrcFdiTm1ta3hGdnVEQmcxU28wZVBObTJDK2lCZ2hRQ0Nad1h6SjBha2x5V0xHSC8rODUvVnh4OS9ySTRkTzJiWmc5cm0ycmR2cjQ0Y09hSXV2L3h5TldUSUVDMXNHWUZqdnM1NWVIREFJQUVFenlETUtGVmxocHhyMXF6UlBUVDVYY1NuMHRLblR4OWRSVWE4NU0reVdKSlpNQW4rdVZKYnZBK0JwQkJBOEJJU3FVSnpic2VQSDlkRDJnNGRPakN2bHBCWTRxWTdBZ2llTy9aWWhnQUVMQk5BOEN3RHh4d0VJT0NPQUlMbmpqMldJUUFCeXdRUVBNdkFNUWNCQ0xnamdPQzVZNDlsQ0VEQU1nRUV6ekp3ekVFQUF1NElJSGp1MkdNWkFoQ3dUQURCc3d3Y2N4Q0FnRHNDQ0o0NzlsaUdBQVFzRTBEd0xBUEhIQVFnNEk0QWd1ZU9QWlloQUFITEJCQTh5OEF4QndFSXVDT0E0TGxqajJVSVFNQXlBUVRQTW5ETVFRQUM3Z2dnZU83WVl4a0NFTEJNQU1HekRCeHpFSUNBT3dJSW5qdjJXSVlBQkN3VFFQQXNBOGNjQkNEZ2pnQ0M1NDQ5bGlFQUFjc0VFRHpMd0RFSEFRaTRJNERndVdPUFpRaEF3RElCQk04eWNNeEJBQUx1Q0NCNDd0aGpHUUlRc0V3QXdiTU1ISE1RZ0lBN0FnaWVPL1pZaGdBRUxCTkE4Q3dEeHh3RUlPQ09BSUxuamoyV0lRQUJ5d1FRUE12QU1RY0JDTGdqZ09DNVk0OWxDRURBTWdFRXp6Snd6RUVBQXU0SUlIanUyR01aQWhDd1RBREJzd3djY3hDQWdEc0NDSjQ3OWxpR0FBUXNFMER3TEFQSEhBUWc0STRBZ3VlT1BaWWhBQUhMQkJBOHk4QXhCd0VJdUNPQTRMbGpqMlVJUU1BeUFRVFBNbkRNUVFBQzdnZ2dlTzdZWXhrQ0VMQk1BTUd6REJ4ekVJQ0FPd0lJbmp2MldJWUFCQ3dUUVBBc0E4Y2NCQ0RnamdDQzU0NDlsaUVBQWNzRUVEekx3REVIQVFpNEk0RGd1V09QWlFoQXdESUJCTTh5Y014QkFBTHVDQ0I0N3RoakdRSVFzRXdBd2JNTUhITVFnSUE3QWdpZU8vWlloZ0FFTEJOQThDd0R4eHdFSU9DT0FJTG5qajJXSVFBQnl3UVFQTXZBTVFjQkNMZ2pnT0M1WTQ5bENFREFNZ0VFenpKd3pFRUFBdTRJSUhqdTJHTVpBaEN3VEFEQnN3d2NjeENBZ0RzQ0NKNDc5bGlHQUFRc0UwRHdMQVBISEFRZzRJNEFndWVPUFpZaEFBSExCQkE4eThBeEJ3RUl1Q09BNExsamoyVUlRTUF5QVFUUE1uRE1RUUFDN2dnZ2VPN1lZeGtDRUxCTUFNR3pEQnh6RUlDQU93SUluanYyV0lZQUJDd1RRUEFzQThjY0JDRGdqZ0NDNTQ0OWxpRUFBY3NFRUR6THdERUhBUWk0STREZ3VXT1BaUWhBd0RJQkJNOHljTXhCQUFMdUNDQjQ3dGhqR1FJUXNFd0F3Yk1NSEhNUWdJQTdBZ2llTy9aWWhnQUVMQk5BOEN3RHh4d0VJT0NPQUlMbmpqMldJUUFCeXdRUVBNdkFNUWNCQ0xnamdPQzVZNDlsQ0VEQU1nRUV6ekp3ekVFQUF1NElJSGp1MkdNWkFoQ3dUQURCc3d3Y2N4Q0FnRHNDQ0o0NzlsaUdBQVFzRTBEd0xBUEhIQVFnNEk0QWd1ZU9QWlloQUFITEJCQTh5OEF4QndFSXVDT0E0TGxqajJVSVFNQXlBUVRQTW5ETVFRQUM3Z2dnZU83WVl4a0NFTEJNQU1HekRCeHpFSUNBT3dJSW5qdjJXSVlBQkN3VFFQQXNBOGNjQkNEZ2pnQ0M1NDQ5bGlFQUFjc0VFRHpMd0RFSEFRaTRJNERndVdPUFpRaEF3RElCQk04eWNNeEJBQUx1Q0NCNDd0aGpHUUlRc0V6Zy93Q21ZalRKQ2Vmb3ZBQUFBQUJKUlU1RXJrSmdnZz09oIID+DCCA/QwggOZoAMCAQICCBWkzYa+f0t/MAwGCCqBHM9VAYN1BQAwgYIxCzAJBgNVBAYTAkNOMRIwEAYDVQQIDAlHdWFuZ2RvbmcxETAPBgNVBAcMCFNoZW56aGVuMScwJQYDVQQKDB5TaGVuWmhlbiBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkxDTALBgNVBAsMBHN6Y2ExFDASBgNVBAMMC1NaQ0EgU00yIENBMB4XDTE3MTEwMzA1NDk0M1oXDTE4MTEwMzA1NDk0M1owgYkxCzAJBgNVBAYTAkNOMRIwEAYDVQQIDAnlub/kuJznnIExEjAQBgNVBAcMCea3seWcs+W4gjETMBEGA1UEDAwKMjAxNzExMDMwNzETMBEGA1UECgwKMjAxNzExMDMwNzETMBEGA1UECwwKMjAxNzExMDMwNzETMBEGA1UEAwwKMjAxNzExMDMwNzCCATMwgewGByqGSM49AgEwgeACAQEwLAYHKoZIzj0BAQIhAP////7/////////////////////AAAAAP//////////MEQEIP////7/////////////////////AAAAAP/////////8BCAo6fqenZ9eNE1ankvPZQmn85eJ9RWrj5LdvL1BTZQOkwRBBDLEriwfGYEZX5kERmo5yZSP4wu/8mYL4XFaRYkzTHTHvDc2ovT2d5xZvc7ja2khU9Cph3zGKkdAAt8y5SE58KACIQD////+////////////////cgPfayHGBStTu/QJOdVBIwIBAQNCAAQRytCbqGRoZQT2gI57b+mZ7PbpqLzi8KqrikhP92tYMVKOAnt3jl2n18tihWirNvjCnVip222nDkV/QCreTk7Wo4IBEDCCAQwwXAYIKwYBBQUHAQEEUDBOMCgGCCsGAQUFBzAChhxodHRwOi8vMTI3LjAuMC4xL2NhaXNzdWUuaHRtMCIGCCsGAQUFBzABhhZodHRwOi8vMTI3LjAuMC4xOjIwNDQzMB8GA1UdIwQYMBaAFEXqN41yP7WmBG/DKsmt3e7my06NMAwGA1UdEwQFMAMBAQAwOQYDVR0gBDIwMDAuBgRVHSAAMCYwJAYIKwYBBQUHAgEWGGh0dHA6Ly8xMjcuMC4wLjEvY3BzLmh0bTAWBgZggRyG7yQEDAwKMjAxNzExMDMwNzALBgNVHQ8EBAMCBsAwHQYDVR0OBBYEFL5p2yv4H1Efg+DpVGu6eKmQHtXkMAwGCCqBHM9VAYN1BQADRwAwRAIgdH45BGyJLCwkxurD7cyuZJAVibPCSfsw//n+eMFpYV0CIGhvDhj+Sd0sKHzGvlPsiJctW/9bKuGKLGE6CX/b7neTMYIB5DCCAeACAQEwgY8wgYIxCzAJBgNVBAYTAkNOMRIwEAYDVQQIDAlHdWFuZ2RvbmcxETAPBgNVBAcMCFNoZW56aGVuMScwJQYDVQQKDB5TaGVuWmhlbiBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkxDTALBgNVBAsMBHN6Y2ExFDASBgNVBAMMC1NaQ0EgU00yIENBAggVpM2Gvn9LfzAMBggqgRzPVQGDEQUAoIHkMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8XDTE3MTIwNTA4NDg0M1owLwYJKoZIhvcNAQkEMSIEIEe1GX/kKDb/1IhcK+Thc9HGFZT6/cbshtx54GeFl/dWMHkGCSqGSIb3DQEJDzFsMGowCwYJYIZIAWUDBAEqMAsGCWCGSAFlAwQBFjALBglghkgBZQMEAQIwCgYIKoZIhvcNAwcwDgYIKoZIhvcNAwICAgCAMA0GCCqGSIb3DQMCAgFAMAcGBSsOAwIHMA0GCCqGSIb3DQMCAgEoMAoGCCqBHM9VAYN1BEgwRgIhAOwnkSgsDzHUxebmQx35Ae1a56LXUkbDue9yaH0+mSazAiEA/S12ZNOboLaN6YMYPaVvZBZIUBwu9HPfi4kJCbvONiY=
////        80527958882111619858163586570007856043309163325684187623998119542811316655888, 31413697264088912702285005498829187216810624166217488418821348528487088129419
//        boolean ff = verifySign(decode, "test".getBytes(), getPubKey());
    	String str1 = "MIIHPgYJKoZIhvcNAQcCoIIHLzCCBysCAQExADALBgkqhkiG9w0BBwGgggcTMIIC0DCCAjmgAwIBAgIIWd1E9c7skXUwDQYJKoZIhvcNAQEFBQAwezELMAkGA1UEBhMCQ04xEjAQBgNVBAgMCUd1YW5nZG9uZzERMA8GA1UEBwwIU2hlbnpoZW4xJzAlBgNVBAoMHlNoZW5aaGVuIENlcnRpZmljYXRlIEF1dGhvcml0eTENMAsGA1UECwwEc3pjYTENMAsGA1UEAwwEU1pDQTAeFw0xNzAyMTUwNjQwMDJaFw00NzAyMDgwNjQwMDJaMHsxCzAJBgNVBAYTAkNOMRIwEAYDVQQIDAlHdWFuZ2RvbmcxETAPBgNVBAcMCFNoZW56aGVuMScwJQYDVQQKDB5TaGVuWmhlbiBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkxDTALBgNVBAsMBHN6Y2ExDTALBgNVBAMMBFNaQ0EwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAJA3tMG+HMNntomNgzq1RCH6Yk4n6Xr3nDjPM9DGY37AosE08kVSKs9D8bx/YyYN5s45YUi5ivU0LjiN9CD2gQwiJOH6hjfj0FwovuEX+tSGenLOD1Vwnn8/dLmsAshzH+CxXb+q2MSarYTuS/4qmEdHb35eE+ACl1WQwouz4BWfAgMBAAGjXTBbMB8GA1UdIwQYMBaAFF7zeTVy2qREYgyiNesEPWbZwD3wMAwGA1UdEwQFMAMBAf8wCwYDVR0PBAQDAgEGMB0GA1UdDgQWBBRe83k1ctqkRGIMojXrBD1m2cA98DANBgkqhkiG9w0BAQUFAAOBgQBrnGRGbNpEWM39Gc236TfNqopwvOnKXzjGuqt1eqw83f4rlQuBB3dm1rtSQn1vtsDJoITK6BHfDG3l9Ktsi2wEPPPP+eoF3DXIF/fXQyg91U1oC+IfeMPM6UCrVOdVJpLMECrsbWi5vGW2ASTxdzBweImrActvRwknuVob0Vx5";
    	String str2 = "MIIHPgYJKoZIhvcNAQcCoIIHLzCCBysCAQExADALBgkqhkiG9w0BBwGgggcTMIIC0DCCAjmgAwIBAgIIWd1E9c7skXUwDQYJKoZIhvcNAQEFBQAwezELMAkGA1UEBhMCQ04xEjAQBgNVBAgMCUd1YW5nZG9uZzERMA8GA1UEBwwIU2hlbnpoZW4xJzAlBgNVBAoMHlNoZW5aaGVuIENlcnRpZmljYXRlIEF1dGhvcml0eTENMAsGA1UECwwEc3pjYTENMAsGA1UEAwwEU1pDQTAeFw0xNzAyMTUwNjQwMDJaFw00NzAyMDgwNjQwMDJaMHsxCzAJBgNVBAYTAkNOMRIwEAYDVQQIDAlHdWFuZ2RvbmcxETAPBgNVBAcMCFNoZW56aGVuMScwJQYDVQQKDB5TaGVuWmhlbiBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkxDTALBgNVBAsMBHN6Y2ExDTALBgNVBAMMBFNaQ0EwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAJA3tMG+HMNntomNgzq1RCH6Yk4n6Xr3nDjPM9DGY37AosE08kVSKs9D8bx/YyYN5s45YUi5ivU0LjiN9CD2gQwiJOH6hjfj0FwovuEX+tSGenLOD1Vwnn8/dLmsAshzH+CxXb+q2MSarYTuS/4qmEdHb35eE+ACl1WQwouz4BWfAgMBAAGjXTBbMB8GA1UdIwQYMBaAFF7zeTVy2qREYgyiNesEPWbZwD3wMAwGA1UdEwQFMAMBAf8wCwYDVR0PBAQDAgEGMB0GA1UdDgQWBBRe83k1ctqkRGIMojXrBD1m2cA98DANBgkqhkiG9w0BAQUFAAOBgQBrnGRGbNpEWM39Gc236TfNqopwvOnKXzjGuqt1eqw83f4rlQuBB3dm1rtSQn1vtsDJoITK6BHfDG3l9Ktsi2wEPPPP+eoF3DXIF/fXQyg91U1oC+IfeMPM6UCrVOdVJpLMECrsbWi5vGW2ASTxdzBweImrActvRwknuVob0Vx5";
    	
        System.out.println(str1.equalsIgnoreCase(str2));
    }
   
   public static boolean verifySign(byte[] signdatebyte, byte[] databyte,X509Certificate cert) throws NoSuchAlgorithmException, 
   InvalidKeyException, SignatureException, IOException{
       
       return verifySign(signdatebyte,databyte,cert.getPublicKey());
   }
   /**
    * PKCS1 验证
    * @param signdate
    *          签名值勤
    * @param data
    *          原文
    * @param cf
    *          签名的证书
    * @return
    *      true 正确
    *      false 错误
    * @throws NoSuchAlgorithmException
    * @throws InvalidKeyException
    * @throws SignatureException
    * @throws IOException 
    */
   public static boolean verifySign(byte[] signdatebyte, byte[] databyte,PublicKey publicKey) throws NoSuchAlgorithmException, 
   InvalidKeyException, SignatureException, IOException{
       SM2Signer localSM2Signer = new SM2Signer();
       Security.addProvider(new BouncyCastleProvider());
//       PublicKey publicKey = cert.getPublicKey();
       ECPublicKeyParameters param = null;
       
       if (publicKey instanceof BCECPublicKey)
       {
           BCECPublicKey localECPublicKey = (BCECPublicKey)publicKey;
           ECParameterSpec localECParameterSpec = localECPublicKey.getParameters();
           ECDomainParameters localECDomainParameters = new ECDomainParameters(localECParameterSpec.getCurve(),
           localECParameterSpec.getG(), localECParameterSpec.getN());
           param = new ECPublicKeyParameters(localECPublicKey.getQ(),localECDomainParameters);
       }
//       ByteArrayInputStream inStream = new ByteArrayInputStream(signdatebyte);
//       ASN1InputStream asnInputStream = new ASN1InputStream(inStream);
//       ASN1Primitive derObject = asnInputStream.readObject();
       BigInteger R = null;
       BigInteger S = null;
//       if (derObject instanceof ASN1Sequence) {  
//           ASN1Sequence signSequence = (ASN1Sequence) derObject;  
//           Enumeration<ASN1Integer> enumer = signSequence.getObjects();
//               R =  ((ASN1Integer)enumer.nextElement()).getValue();
//               S =  ((ASN1Integer)enumer.nextElement()).getValue();
//       }
       byte[] f1 = new byte[32];
       byte[] f2 = new byte[32];
       System.arraycopy(signdatebyte, 0, f1, 0, 32);
       System.arraycopy(signdatebyte, 32, f2, 0, signdatebyte.length-32);
       ParametersWithID parametersWithID = new ParametersWithID(param,SM2_USER_ID);
       localSM2Signer.init(false, parametersWithID);
       System.out.println(BigIntegerUtil.toPositiveInteger(f1));
       System.out.println(BigIntegerUtil.toPositiveInteger(f2));
       boolean res = localSM2Signer.verifySignature(databyte, BigIntegerUtil.toPositiveInteger(f1),
           BigIntegerUtil.toPositiveInteger(f2));
       return res;
   }
   
   
   @SuppressWarnings("unused")
    private static byte[] getByteArrayByFilePath(String filepath){
           
           FileChannel fc = null; 
           byte data[] = null;
           try {  
               fc = new RandomAccessFile(filepath, "r").getChannel();  
               MappedByteBuffer byteBuffer = fc.map(MapMode.READ_ONLY, 0,  
                       fc.size()).load();  
               data = new byte[(int) fc.size()];  
               if (byteBuffer.remaining() > 0) {  
                   byteBuffer.get(data, 0, byteBuffer.remaining());  
               }  
           } catch (IOException e) {  
               e.printStackTrace();  
           } finally {  
               try {
                   if(fc != null )
                   fc.close();  
               } catch (IOException e) {  
                   e.printStackTrace();  
               }  
           }
           return data;
     }
   
   

   private static PublicKey getPubKey() {
       PublicKey publicKey = null;
       try {
              String publicBase64 = publicKeyStr;
              java.security.spec.X509EncodedKeySpec bobPubKeySpec = new java.security.spec.X509EncodedKeySpec(
              new BASE64Decoder().decodeBuffer(publicBase64));
            KeyFactory keyFactory;
            keyFactory = java.security.KeyFactory.getInstance("EC", new BouncyCastleProvider());
            // 取公钥匙对象
            publicKey = keyFactory.generatePublic(bobPubKeySpec);
            System.out.println(publicKey);
       } catch (Exception e) {
        e.printStackTrace();
       }
       return publicKey;
      }
   
   private static PrivateKey getPrivateKey() {
       PrivateKey privateKey = null;
       try {
              String publicBase64 = privateStr;
              PKCS8EncodedKeySpec keySpec = new PKCS8EncodedKeySpec(new BASE64Decoder().decodeBuffer(publicBase64));
            KeyFactory keyFactory;
            keyFactory = java.security.KeyFactory.getInstance("EC", new BouncyCastleProvider());
            privateKey = keyFactory.generatePrivate(keySpec);
            System.out.println(privateKey);
            System.out.println(Base64.encodeBase64String((privateKey.getEncoded())).endsWith(publicBase64));
       } catch (Exception e) {
        e.printStackTrace();
       }
       return privateKey;
      }

}
